# üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

## üìä –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –ø—Ä–æ–±–ª–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ü–†–û–ë–õ–ï–ú–ê: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ë—Ä–∞—É–∑–µ—Ä        ‚îÇ         ‚îÇ  Edge Function   ‚îÇ         ‚îÇ  –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö     ‚îÇ
‚îÇ  (Frontend)      ‚îÇ         ‚îÇ  (process-pdf)   ‚îÇ         ‚îÇ  (PostgreSQL)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ  1. –ó–∞–≥—Ä—É–∑–∫–∞ .txt         ‚îÇ                            ‚îÇ
         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  2. –°–æ–∑–¥–∞–Ω–∏–µ embeddings   ‚îÇ
         ‚îÇ                            ‚îÇ     (Jina AI v3)          ‚îÇ
         ‚îÇ                            ‚îÇ     –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: 1024     ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  3. –ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å     ‚îÇ
         ‚îÇ                            ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
         ‚îÇ                            ‚îÇ     vector(1024)           ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  ‚ùå –û–®–ò–ë–ö–ê!               ‚îÇ
         ‚îÇ                            ‚îÇ  –¢–∞–±–ª–∏—Ü–∞ —Ç—Ä–µ–±—É–µ—Ç:          ‚îÇ
         ‚îÇ                            ‚îÇ  vector(1536)              ‚îÇ
         ‚îÇ                            ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ  ‚ùå "non-2xx status"       ‚îÇ                            ‚îÇ
         ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                            ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
```

## üî¥ –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ #1: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π

### –ß—Ç–æ –±—ã–ª–æ:
```sql
-- –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è OpenAI embeddings
CREATE TABLE document_chunks (
  embedding vector(1536),  -- ‚ùå OpenAI —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
  ...
);

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 1536
CREATE FUNCTION search_similar_chunks(
  query_embedding vector(1536),  -- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
  ...
)
```

### –ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```typescript
// Edge Function –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Jina AI
const response = await fetch('https://api.jina.ai/v1/embeddings', {
  body: JSON.stringify({
    model: 'jina-embeddings-v3',  // ‚úÖ –°–æ–∑–¥–∞–µ—Ç vector(1024)
    input: [text],
  })
});
```

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç:
```
Jina AI v3 ‚Üí —Å–æ–∑–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ 1024
PostgreSQL ‚Üí –æ–∂–∏–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ 1536
–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –û–®–ò–ë–ö–ê –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ INSERT
```

## üî¥ –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ API –∫–ª—é—á–∞

```typescript
// –í Edge Function:
const jinaApiKey = Deno.env.get('JINA_API_KEY');
if (!jinaApiKey) {
  throw new Error('JINA_API_KEY is not configured'); // ‚ùå
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `JINA_API_KEY` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ Supabase Edge Functions.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ß–∞—Å—Ç—å 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏

```
–ú–ò–ì–†–ê–¶–ò–Ø:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π                       ‚îÇ
‚îÇ    DROP FUNCTION search_similar_chunks         ‚îÇ
‚îÇ    DROP INDEX document_chunks_embedding_idx    ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ 2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏                       ‚îÇ
‚îÇ    ALTER COLUMN embedding TYPE vector(1024)    ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ 3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞                        ‚îÇ
‚îÇ    CREATE INDEX ... USING ivfflat              ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ 4. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏                        ‚îÇ
‚îÇ    CREATE FUNCTION ... vector(1024)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ß–∞—Å—Ç—å 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

```
–°–ï–ö–†–ï–¢–´ SUPABASE:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Settings ‚Üí Edge Functions ‚Üí Secrets            ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ [+] Add Secret                                 ‚îÇ
‚îÇ     Name:  JINA_API_KEY                        ‚îÇ
‚îÇ     Value: jina_xxxxxxxxxxxxx                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìà –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ë—Ä–∞—É–∑–µ—Ä        ‚îÇ         ‚îÇ  Edge Function   ‚îÇ         ‚îÇ  –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö     ‚îÇ
‚îÇ  (Frontend)      ‚îÇ         ‚îÇ  (process-pdf)   ‚îÇ         ‚îÇ  (PostgreSQL)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ  1. –ó–∞–≥—Ä—É–∑–∫–∞ .txt         ‚îÇ                            ‚îÇ
         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  ‚úÖ JINA_API_KEY –Ω–∞–π–¥–µ–Ω   ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  2. –°–æ–∑–¥–∞–Ω–∏–µ embeddings   ‚îÇ
         ‚îÇ                            ‚îÇ     (Jina AI v3)          ‚îÇ
         ‚îÇ                            ‚îÇ     –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: 1024     ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ             ‚îÇ
         ‚îÇ                            ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
         ‚îÇ                            ‚îÇ     vector(1024)           ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ                            ‚îÇ  ‚úÖ –£–°–ü–ï–•!                ‚îÇ
         ‚îÇ                            ‚îÇ  –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:        ‚îÇ
         ‚îÇ                            ‚îÇ  vector(1024)              ‚îÇ
         ‚îÇ                            ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
         ‚îÇ                            ‚îÇ                            ‚îÇ
         ‚îÇ  ‚úÖ "–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ"    ‚îÇ                            ‚îÇ
         ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                            ‚îÇ
         ‚îÇ                            ‚îÇ                            ‚îÇ
```

---

## üî¨ –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 1: Frontend (DocumentUploader.tsx)
```typescript
// –°—Ç—Ä–æ–∫–∏ 59-64
const { data, error } = await supabase.functions.invoke('process-pdf', {
  body: {
    pdfText: text,          // ‚úÖ –¢–µ–∫—Å—Ç —Ñ–∞–π–ª–∞
    documentName: documentName.trim()  // ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  }
});
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 2: Edge Function (process-pdf/index.ts)

#### –ü—Ä–æ–±–ª–µ–º–∞ A: API –∫–ª—é—á
```typescript
// –°—Ç—Ä–æ–∫–∞ 71
const jinaApiKey = Deno.env.get('JINA_API_KEY');
if (!jinaApiKey) {
  throw new Error('JINA_API_KEY is not configured'); // ‚ùå –û—à–∏–±–∫–∞
}
```
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å JINA_API_KEY –≤ —Å–µ–∫—Ä–µ—Ç—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ B: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
```typescript
// –°—Ç—Ä–æ–∫–∏ 34-44
async function createEmbedding(text: string, apiKey: string): Promise<number[]> {
  const response = await fetch('https://api.jina.ai/v1/embeddings', {
    body: JSON.stringify({
      model: 'jina-embeddings-v3',  // –°–æ–∑–¥–∞–µ—Ç 1024-–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
      input: [text],
    })
  });
  return data.data[0].embedding;  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç number[1024]
}
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –≤–µ–∫—Ç–æ—Ä –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ë–î

---

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL + pgvector)

#### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü–∞
```sql
-- –ú–∏–≥—Ä–∞—Ü–∏—è 20251007095340_...sql (—Å—Ç—Ä–æ–∫–∞ 8)
CREATE TABLE public.document_chunks (
  embedding vector(1536),  -- ‚ùå –¢—Ä–µ–±—É–µ—Ç 1536 –∏–∑–º–µ—Ä–µ–Ω–∏–π
  ...
);
```
**–†–µ—à–µ–Ω–∏–µ:** ALTER COLUMN embedding TYPE vector(1024)

#### –ü—Ä–æ–±–ª–µ–º–∞: –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞
```sql
-- –°—Ç—Ä–æ–∫–∏ 26-27
CREATE FUNCTION public.search_similar_chunks(
  query_embedding vector(1536),  -- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
  ...
)
```
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å vector(1024)

#### –ü—Ä–æ–±–ª–µ–º–∞: –ò–Ω–¥–µ–∫—Å
```sql
-- –°—Ç—Ä–æ–∫–∞ 16
CREATE INDEX document_chunks_embedding_idx 
ON public.document_chunks 
USING ivfflat (embedding vector_cosine_ops);
```
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
```sql
-- –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
SELECT 
  column_name, 
  data_type, 
  udt_name
FROM information_schema.columns
WHERE table_name = 'document_chunks' 
  AND column_name = 'embedding';

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- column_name | data_type | udt_name
-- embedding   | USER-DEFINED | vector

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏:
SELECT pg_typeof(embedding) 
FROM document_chunks 
LIMIT 1;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: vector(1024)
```

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞
```bash
# –í –ª–æ–≥–∞—Ö Edge Function –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
Creating embedding for chunk (length: ...)

# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
JINA_API_KEY is not configured
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å—Ç–∞–≤–∫–∏
```sql
-- –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:
SELECT 
  document_name,
  COUNT(*) as chunks_count,
  AVG(array_length(embedding::float[], 1)) as avg_dimension
FROM document_chunks
GROUP BY document_name;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- avg_dimension –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1024
```

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π embeddings

| –ú–æ–¥–µ–ª—å | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|--------|-------------|---------------|
| OpenAI text-embedding-3-small | 1536 | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| OpenAI text-embedding-3-large | 3072 | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| **Jina AI v3** | **1024** | **‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** |
| Jina AI v2 | 768 | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| Cohere embed-multilingual-v3 | 1024 | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

### –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

- [Jina AI Embeddings](https://jina.ai/embeddings/)
- [pgvector Extension](https://github.com/pgvector/pgvector)
- [Supabase Edge Functions](https://supabase.com/docs/guides/functions)
- [PostgreSQL Vector Types](https://github.com/pgvector/pgvector#vector-types)

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ß—Ç–æ –±—ã–ª–æ | –ß—Ç–æ —Å—Ç–∞–ª–æ |
|------|----------|-----------|
| 2025-10-07 | –°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å vector(1536) | - |
| 2025-10-08 | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ | - |
| 2025-10-08 | –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è | vector(1024) |
| 2025-10-08 | –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | FIX_UPLOAD_ERROR.md |

---

**–ê–≤—Ç–æ—Ä –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:** AI Assistant  
**–î–∞—Ç–∞:** 2025-10-08  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0

